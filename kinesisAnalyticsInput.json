{
    "ApplicationName": "workshopTelemetryKAApp",
    "ApplicationDescription": "Workshop GAM310 - Sample Kinesis Analytics App",
    "Inputs": [
        {
            "NamePrefix": "GAME_BOT",
            "KinesisStreamsInput": {
                "ResourceARN": "arn:aws:kinesis:us-west-2:varAccountID:stream/workshopTelemetryStream",
                "RoleARN": "arn:aws:iam::varAccountID:role/service-role/kinesisanalytics_delivery_role"
            },
            "InputParallelism": {
                "Count": 1
            },
            "InputSchema": {
                "RecordFormat": {
                    "RecordFormatType": "JSON",
                    "MappingParameters": {
                        "JSONMappingParameters": {
                            "RecordRowPath": "$"
                        }
                    }
                },
                "RecordEncoding": "UTF-8",
                "RecordColumns": [
                    {
                        "Name": "datestamp",
                        "Mapping": "$.datestamp",
                        "SqlType": "TIMESTAMP"
                    },
                    {
                        "Name": "playerid",
                        "Mapping": "$.playerid",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "playerlevel",
                        "Mapping": "$.playerlevel",
                        "SqlType": "VARCHAR(16)"
                    },
                    {
                        "Name": "squadelementmap",
                        "Mapping": "$.squadelementmap",
                        "SqlType": "VARCHAR(8)"
                    },
                    {
                        "Name": "gamenumber",
                        "Mapping": "$.gamenumber",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "squadpower",
                        "Mapping": "$.squadpower",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "squadagility",
                        "Mapping": "$.squadagility",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "squadhealth",
                        "Mapping": "$.squadhealth",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "squadluck",
                        "Mapping": "$.squadluck",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "squadspecial",
                        "Mapping": "$.squadspecial",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "squadguard",
                        "Mapping": "$.squadguard",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "squaddamage",
                        "Mapping": "$.squaddamage",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "squadinventoryitemcount",
                        "Mapping": "$.squadinventoryitemcount",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "bosspower",
                        "Mapping": "$.bosspower",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "bossagility",
                        "Mapping": "$.bossagility",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "bosshealth",
                        "Mapping": "$.bosshealth",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "bossluck",
                        "Mapping": "$.bossluck",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "bossspecial",
                        "Mapping": "$.bossspecial",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "bossguard",
                        "Mapping": "$.bossguard",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "bossdamage",
                        "Mapping": "$.bossdamage",
                        "SqlType": "INTEGER"
                    },
                    {
                        "Name": "COL_result",
                        "Mapping": "$.result",
                        "SqlType": "VARCHAR(8)"
                    }
                ]
            },
            "InputStartingPositionConfiguration": {
                "InputStartingPosition": "NOW"
            }
        }
    ],
    "Outputs": [
        {
            "Name": "WORKSHOP_TELEMETRY2_FH_STREAM",
            "KinesisFirehoseOutput": {
                "ResourceARN": "arn:aws:firehose:us-west-2:varAccountID:deliverystream/workshopTelemetryFHDirect",
                "RoleARN": "arn:aws:iam::varAccountID:role/service-role/kinesisanalytics_delivery_role"
            },
            "DestinationSchema": {
                "RecordFormatType": "JSON"
            }
        }
    ],
    "CloudWatchLoggingOptions": [
        {
            "LogStreamARN": "arn:aws:logs:us-west-2:varAccountID:log-group:/aws/kinesisanalytics/workshopTelemetryKAApp:*",
            "RoleARN": "arn:aws:iam::varAccountID:role/service-role/kinesisanalytics_delivery_role"
        }
    ],
    "ApplicationCode": "CREATE OR REPLACE STREAM \"WORKSHOP_TELEMETRY2_FH_STREAM\" (\r\n    \"datestamp\" timestamp, \"playerid\" bigint, \"playerlevel\" VARCHAR(8), \"squadelementmap\" VARCHAR(8), \"gamenumber\" integer, \"squadpower\" integer, \"squadagility\" integer, \"squadhealth\" integer, \"squadluck\" integer, \"squadspecial\" integer,\r\n    \"squadguard\" integer, \"squaddamage\" integer, \"squadinventoryitemcount\" integer, \"bosspower\" integer, \"bossagility\" integer, \"bosshealth\" integer, \"bossluck\" integer, \"bossspecial\" integer, \"bossguard\" integer, \"bossdamage\" integer, \"result\" VARCHAR(4));\r\n\r\nCREATE OR REPLACE PUMP \"STREAM_PUMP\" AS INSERT INTO \"WORKSHOP_TELEMETRY2_FH_STREAM\" \r\nSELECT STREAM \"datestamp\", \"playerid\", \"playerlevel\", \"squadelementmap\", \"gamenumber\", \"squadpower\", \"squadagility\", \"squadhealth\", \"squadluck\", \"squadspecial\",\r\n    \"squadguard\", \"squaddamage\", \"squadinventoryitemcount\", \"bosspower\", \"bossagility\", \"bosshealth\", \"bossluck\", \"bossspecial\", \"bossguard\", \"bossdamage\", \"COL_result\"\r\nFROM \"SOURCE_SQL_STREAM_001\" where \"COL_result\"='DNF';\n"
}
